---
import { getCollection } from 'astro:content';
import Layout from '~/layouts/PageLayout.astro';

export async function getStaticPaths() {
  const workshops = await getCollection('workshop');
  return workshops.map((workshop) => ({
    params: { slug: workshop.data.slug || workshop.id.replace(/\.md$/, '') },
  }));
}

const { slug } = Astro.params;
const workshops = await getCollection('workshop');

if (!workshops || workshops.length === 0) {
  throw new Error('Workshop not found');
}

const { title, excerpt, image, publishDate, price, duration, instructor } = workshops[0].data;
const body = workshops[0].body;

console.log(workshops);
const metadata = {
  title: title,
};
---

<Layout metadata={metadata}>
  <article class="max-w-2xl mx-auto p-4">
    <h1 class="text-3xl font-bold">{title}</h1>
    <img src={image} alt={title} class="w-full h-48 object-cover" />
    <p class="text-gray-600">{excerpt}</p>
    <p><strong>Instructor:</strong> {instructor}</p>
    <p><strong>Duration:</strong> {duration}</p>
    <p><strong>Price:</strong> ${price}</p>
    <p><strong>Publish Date:</strong> {publishDate ? new Date(publishDate).toLocaleDateString() : 'N/A'}</p>
    <div>
      <h2 class="text-2xl">Workshop Details</h2>
      <p>{body}</p>
    </div>
  </article>
</Layout>
